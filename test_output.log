PROJECT_ROOT: /mnt/c/Users/Максим/Downloads/ozon_shorter/ozon_shortner
TEST_DIR: ./internal/api/server/restapi/handler
=== RUN   TestHandler
    logger.go:146: 2025-02-11T02:23:33.103+0300	ERROR	handler/handler.go:55	server http handler request
=== RUN   TestHandler/TestCreateShortLink_DuplicateOriginalLink
    logger.go:146: 2025-02-11T02:23:33.108+0300	INFO	handler/handler.go:69	Received HTTP request	{"method": "POST", "path": "/shortner_link"}
    logger.go:146: 2025-02-11T02:23:33.108+0300	INFO	handler/handler.go:77	h.router is not nil, processing request
    logger.go:146: 2025-02-11T02:23:33.108+0300	INFO	handler/link.go:15	CreateShortLinkHandler: handling request	{"original_url": "http://test/func/service.ru"}
    logger.go:146: 2025-02-11T02:23:33.109+0300	DEBUG	handler/generate_short_link.go:24	No existing short link found, generating new one	{"original": "http://test/func/service.ru"}
10 4
    logger.go:146: 2025-02-11T02:23:33.110+0300	DEBUG	postgresql/link.go:38	INSERT INTO links (original_link,short_link) VALUES (http://test/func/service.ru,http://Njg)
    logger.go:146: 2025-02-11T02:23:33.111+0300	INFO	handler/generate_short_link.go:48	Generated new link	{"original": "http://test/func/service.ru", "short": "http://Njg"}
    logger.go:146: 2025-02-11T02:23:33.111+0300	INFO	handler/link.go:33	CreateShortLinkHandler: short link created successfully	{"original_url": "http://test/func/service.ru", "short_url": "http://Njg"}
    logger.go:146: 2025-02-11T02:23:33.112+0300	INFO	handler/handler.go:69	Received HTTP request	{"method": "POST", "path": "/shortner_link"}
    logger.go:146: 2025-02-11T02:23:33.112+0300	INFO	handler/handler.go:77	h.router is not nil, processing request
    logger.go:146: 2025-02-11T02:23:33.112+0300	INFO	handler/link.go:15	CreateShortLinkHandler: handling request	{"original_url": "http://test/func/service.ru"}
    logger.go:146: 2025-02-11T02:23:33.113+0300	DEBUG	handler/generate_short_link.go:21	Found existing short link	{"original": "http://test/func/service.ru", "short": "http://Njg"}
    logger.go:146: 2025-02-11T02:23:33.113+0300	INFO	handler/link.go:33	CreateShortLinkHandler: short link created successfully	{"original_url": "http://test/func/service.ru", "short_url": "http://Njg"}
=== RUN   TestHandler/TestCreateShortLink_EmptyOriginalLink
    logger.go:146: 2025-02-11T02:23:33.113+0300	INFO	handler/handler.go:69	Received HTTP request	{"method": "POST", "path": "/shortner_link"}
    logger.go:146: 2025-02-11T02:23:33.113+0300	INFO	handler/handler.go:77	h.router is not nil, processing request
    logger.go:146: 2025-02-11T02:23:33.114+0300	INFO	handler/link.go:15	CreateShortLinkHandler: handling request	{"original_url": ""}
    logger.go:146: 2025-02-11T02:23:33.114+0300	WARN	handler/link.go:18	CreateShortLinkHandler: original_url is required
=== RUN   TestHandler/TestCreateShortLink_Http_ValidPass
    logger.go:146: 2025-02-11T02:23:33.114+0300	INFO	handler/handler.go:69	Received HTTP request	{"method": "POST", "path": "/shortner_link"}
    logger.go:146: 2025-02-11T02:23:33.114+0300	INFO	handler/handler.go:77	h.router is not nil, processing request
    logger.go:146: 2025-02-11T02:23:33.114+0300	INFO	handler/link.go:15	CreateShortLinkHandler: handling request	{"original_url": "http://test/func/service.ru"}
    logger.go:146: 2025-02-11T02:23:33.115+0300	DEBUG	handler/generate_short_link.go:24	No existing short link found, generating new one	{"original": "http://test/func/service.ru"}
10 4
    logger.go:146: 2025-02-11T02:23:33.116+0300	DEBUG	postgresql/link.go:38	INSERT INTO links (original_link,short_link) VALUES (http://test/func/service.ru,http://n5M)
    logger.go:146: 2025-02-11T02:23:33.117+0300	INFO	handler/generate_short_link.go:48	Generated new link	{"original": "http://test/func/service.ru", "short": "http://n5M"}
    logger.go:146: 2025-02-11T02:23:33.117+0300	INFO	handler/link.go:33	CreateShortLinkHandler: short link created successfully	{"original_url": "http://test/func/service.ru", "short_url": "http://n5M"}
=== RUN   TestHandler/TestCreateShortLink_Https_ValidPass
    logger.go:146: 2025-02-11T02:23:33.118+0300	INFO	handler/handler.go:69	Received HTTP request	{"method": "POST", "path": "/shortner_link"}
    logger.go:146: 2025-02-11T02:23:33.118+0300	INFO	handler/handler.go:77	h.router is not nil, processing request
    logger.go:146: 2025-02-11T02:23:33.118+0300	INFO	handler/link.go:15	CreateShortLinkHandler: handling request	{"original_url": "https://test/func/service.ru"}
    logger.go:146: 2025-02-11T02:23:33.118+0300	DEBUG	handler/generate_short_link.go:24	No existing short link found, generating new one	{"original": "https://test/func/service.ru"}
10 5
    logger.go:146: 2025-02-11T02:23:33.119+0300	DEBUG	postgresql/link.go:38	INSERT INTO links (original_link,short_link) VALUES (https://test/func/service.ru,https://0w)
    logger.go:146: 2025-02-11T02:23:33.120+0300	INFO	handler/generate_short_link.go:48	Generated new link	{"original": "https://test/func/service.ru", "short": "https://0w"}
    logger.go:146: 2025-02-11T02:23:33.120+0300	INFO	handler/link.go:33	CreateShortLinkHandler: short link created successfully	{"original_url": "https://test/func/service.ru", "short_url": "https://0w"}
=== RUN   TestHandler/TestCreateShortLink_LongOriginalLink
    logger.go:146: 2025-02-11T02:23:33.121+0300	INFO	handler/handler.go:69	Received HTTP request	{"method": "POST", "path": "/shortner_link"}
    logger.go:146: 2025-02-11T02:23:33.121+0300	INFO	handler/handler.go:77	h.router is not nil, processing request
    logger.go:146: 2025-02-11T02:23:33.121+0300	INFO	handler/link.go:15	CreateShortLinkHandler: handling request	{"original_url": "https://aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"}
    logger.go:146: 2025-02-11T02:23:33.122+0300	DEBUG	handler/generate_short_link.go:24	No existing short link found, generating new one	{"original": "https://aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"}
10 5
    logger.go:146: 2025-02-11T02:23:33.123+0300	DEBUG	postgresql/link.go:38	INSERT INTO links (original_link,short_link) VALUES (https://aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa,https://sQ)
    logger.go:146: 2025-02-11T02:23:33.124+0300	INFO	handler/generate_short_link.go:48	Generated new link	{"original": "https://aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "short": "https://sQ"}
    logger.go:146: 2025-02-11T02:23:33.124+0300	INFO	handler/link.go:33	CreateShortLinkHandler: short link created successfully	{"original_url": "https://aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "short_url": "https://sQ"}
=== RUN   TestHandler/TestCreateShortLink_NoValidPass
    logger.go:146: 2025-02-11T02:23:33.125+0300	INFO	handler/handler.go:69	Received HTTP request	{"method": "POST", "path": "/shortner_link"}
    logger.go:146: 2025-02-11T02:23:33.125+0300	INFO	handler/handler.go:77	h.router is not nil, processing request
    logger.go:146: 2025-02-11T02:23:33.125+0300	INFO	handler/link.go:15	CreateShortLinkHandler: handling request	{"original_url": "12345"}
    logger.go:146: 2025-02-11T02:23:33.125+0300	DEBUG	handler/generate_short_link.go:24	No existing short link found, generating new one	{"original": "12345"}
    logger.go:146: 2025-02-11T02:23:33.125+0300	ERROR	handler/generate_short_link.go:28	Invalid URL, cannot generate short link	{"url": "12345", "error": "invalid URL: parse \"12345\": invalid URI for request"}
    logger.go:146: 2025-02-11T02:23:33.126+0300	ERROR	handler/link.go:25	CreateShortLinkHandler: error generating short link	{"error": "invalid URL, cannot generate short link: invalid URL: parse \"12345\": invalid URI for request"}
=== RUN   TestHandler/TestGetOriginalLink_EmptyShortLink
    logger.go:146: 2025-02-11T02:23:33.126+0300	INFO	handler/handler.go:69	Received HTTP request	{"method": "GET", "path": "/original_link"}
    logger.go:146: 2025-02-11T02:23:33.126+0300	INFO	handler/handler.go:77	h.router is not nil, processing request
=== RUN   TestHandler/TestGetOriginalLink_InvalidShortLink
    logger.go:146: 2025-02-11T02:23:33.127+0300	INFO	handler/handler.go:69	Received HTTP request	{"method": "GET", "path": "/original_link"}
    logger.go:146: 2025-02-11T02:23:33.127+0300	INFO	handler/handler.go:77	h.router is not nil, processing request
    logger.go:146: 2025-02-11T02:23:33.128+0300	INFO	handler/link.go:43	GetOriginalLinkHandler: handling request	{"short_link": "invalidShortLink"}
    logger.go:146: 2025-02-11T02:23:33.128+0300	ERROR	handler/link.go:47	GetOriginalLinkHandler: error fetching original link	{"error": "sql: no rows in result set", "short_link": "invalidShortLink"}
=== RUN   TestHandler/TestGetOriginalLink_ValidShortLink
    logger.go:146: 2025-02-11T02:23:33.129+0300	INFO	handler/handler.go:69	Received HTTP request	{"method": "POST", "path": "/shortner_link"}
    logger.go:146: 2025-02-11T02:23:33.129+0300	INFO	handler/handler.go:77	h.router is not nil, processing request
    logger.go:146: 2025-02-11T02:23:33.129+0300	INFO	handler/link.go:15	CreateShortLinkHandler: handling request	{"original_url": "http://test/func/service.ru"}
    logger.go:146: 2025-02-11T02:23:33.130+0300	DEBUG	handler/generate_short_link.go:24	No existing short link found, generating new one	{"original": "http://test/func/service.ru"}
10 4
    logger.go:146: 2025-02-11T02:23:33.131+0300	DEBUG	postgresql/link.go:38	INSERT INTO links (original_link,short_link) VALUES (http://test/func/service.ru,http://ySE)
    logger.go:146: 2025-02-11T02:23:33.134+0300	INFO	handler/generate_short_link.go:48	Generated new link	{"original": "http://test/func/service.ru", "short": "http://ySE"}
    logger.go:146: 2025-02-11T02:23:33.134+0300	INFO	handler/link.go:33	CreateShortLinkHandler: short link created successfully	{"original_url": "http://test/func/service.ru", "short_url": "http://ySE"}
    logger.go:146: 2025-02-11T02:23:33.134+0300	INFO	handler/handler.go:69	Received HTTP request	{"method": "GET", "path": "/original_link"}
    logger.go:146: 2025-02-11T02:23:33.134+0300	INFO	handler/handler.go:77	h.router is not nil, processing request
    logger.go:146: 2025-02-11T02:23:33.134+0300	INFO	handler/link.go:43	GetOriginalLinkHandler: handling request	{"short_link": "http://ySE"}
    logger.go:146: 2025-02-11T02:23:33.135+0300	INFO	handler/link.go:54	GetOriginalLinkHandler: original link retrieved successfully	{"short_link": "http://ySE", "original_url": "http://test/func/service.ru"}
--- PASS: TestHandler (0.10s)
    --- PASS: TestHandler/TestCreateShortLink_DuplicateOriginalLink (0.01s)
    --- PASS: TestHandler/TestCreateShortLink_EmptyOriginalLink (0.00s)
    --- PASS: TestHandler/TestCreateShortLink_Http_ValidPass (0.00s)
    --- PASS: TestHandler/TestCreateShortLink_Https_ValidPass (0.00s)
    --- PASS: TestHandler/TestCreateShortLink_LongOriginalLink (0.00s)
    --- PASS: TestHandler/TestCreateShortLink_NoValidPass (0.00s)
    --- PASS: TestHandler/TestGetOriginalLink_EmptyShortLink (0.00s)
    --- PASS: TestHandler/TestGetOriginalLink_InvalidShortLink (0.00s)
    --- PASS: TestHandler/TestGetOriginalLink_ValidShortLink (0.01s)
PASS
ok  	github.com/Maksim646/ozon_shortner/internal/api/server/restapi/handler	(cached)
